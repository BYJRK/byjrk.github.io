<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="åœ¨å¤šçº¿ç¨‹æƒ…å½¢ä¸‹ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¼šå¸Œæœ›æœ‰åŠæ³•æ±‡æŠ¥è¿›åº¦ï¼Œå´å¸¸å¸¸ä¼šé‡åˆ°çº¿ç¨‹ä¸å®‰å…¨ä¹‹ç±»çš„é—®é¢˜ã€‚é‚£ä¹ˆå®˜æ–¹ç»™å‡ºçš„å®è·µæ–¹å¼æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ"><title>å¦‚ä½•åœ¨å¼‚æ­¥ä»»åŠ¡ä¸­æ±‡æŠ¥è¿›åº¦</title>
<link rel=canonical href=https://blog.coldwind.top/posts/how-to-report-progress/><link rel=stylesheet href=/scss/style.min.e5e73594e070d9646bf09518a8b459c3f8c19c6ca92a47d90b9cb43bd1bcd3c8.css><meta property='og:title' content="å¦‚ä½•åœ¨å¼‚æ­¥ä»»åŠ¡ä¸­æ±‡æŠ¥è¿›åº¦"><meta property='og:description' content="åœ¨å¤šçº¿ç¨‹æƒ…å½¢ä¸‹ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¼šå¸Œæœ›æœ‰åŠæ³•æ±‡æŠ¥è¿›åº¦ï¼Œå´å¸¸å¸¸ä¼šé‡åˆ°çº¿ç¨‹ä¸å®‰å…¨ä¹‹ç±»çš„é—®é¢˜ã€‚é‚£ä¹ˆå®˜æ–¹ç»™å‡ºçš„å®è·µæ–¹å¼æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ"><meta property='og:url' content='https://blog.coldwind.top/posts/how-to-report-progress/'><meta property='og:site_name' content='å¯’æµã®ç¼–ç¨‹ç¬”è®°'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='csharp'><meta property='article:tag' content='dotnet'><meta property='article:tag' content='async'><meta property='article:tag' content='wpf'><meta property='article:published_time' content='2024-05-09T00:00:00+00:00'><meta property='article:modified_time' content='2024-05-09T00:00:00+00:00'><meta property='og:image' content='https://s2.loli.net/2024/05/09/RJYeMSKs5q6UdQn.jpg'><meta name=twitter:title content="å¦‚ä½•åœ¨å¼‚æ­¥ä»»åŠ¡ä¸­æ±‡æŠ¥è¿›åº¦"><meta name=twitter:description content="åœ¨å¤šçº¿ç¨‹æƒ…å½¢ä¸‹ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¼šå¸Œæœ›æœ‰åŠæ³•æ±‡æŠ¥è¿›åº¦ï¼Œå´å¸¸å¸¸ä¼šé‡åˆ°çº¿ç¨‹ä¸å®‰å…¨ä¹‹ç±»çš„é—®é¢˜ã€‚é‚£ä¹ˆå®˜æ–¹ç»™å‡ºçš„å®è·µæ–¹å¼æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://s2.loli.net/2024/05/09/RJYeMSKs5q6UdQn.jpg'><link rel="shortcut icon" href=/favicon.png><link href=/css/fontawesome.min.css rel=stylesheet><link href=/css/brands.min.css rel=stylesheet><link href=/css/solid.min.css rel=stylesheet><link href=/css/regular.min.css rel=stylesheet></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu16872897465854023674.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>â˜˜ï¸</span></figure><div class=site-meta><h1 class=site-name><a href=/>å¯’æµã®ç¼–ç¨‹ç¬”è®°</a></h1><h2 class=site-description>è®°å½•é‚£äº›ç¨çºµå³é€çš„ç¼–ç¨‹å¿ƒå¾—ã€‚</h2></div></header><ol class=menu-social><li><a href=https://github.com/BYJRK target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://space.bilibili.com/600592 target=_blank title=Bilibili rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 014-4h10a4 4 0 014 4v6a4 4 0 01-4 4H7a4 4 0 01-4-4v-6z"/><path d="M8 3l2 3"/><path d="M16 3l-2 3"/><path d="M9 13v-2"/><path d="M15 11v2"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-rss"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>ä¸»é¡µ</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>å…³äºæˆ‘</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><h2 class="widget-title section-title" style=font-size:2rem>ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#æ­å»ºé¡¹ç›®>æ­å»ºé¡¹ç›®</a></li><li><a href=#ä½¿ç”¨-progress-ç±»>ä½¿ç”¨ Progress ç±»</a></li><li><a href=#å®ç°è‡ªå®šä¹‰-progress-ç±»>å®ç°è‡ªå®šä¹‰ Progress ç±»</a></li><li><a href=#æ€»ç»“>æ€»ç»“</a></li><li><a href=#å‚è€ƒ>å‚è€ƒ</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/posts/how-to-report-progress/><img src=https://s2.loli.net/2024/05/09/RJYeMSKs5q6UdQn.jpg loading=lazy alt="Featured image of post å¦‚ä½•åœ¨å¼‚æ­¥ä»»åŠ¡ä¸­æ±‡æŠ¥è¿›åº¦"></a></div><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/how-to-report-progress/>å¦‚ä½•åœ¨å¼‚æ­¥ä»»åŠ¡ä¸­æ±‡æŠ¥è¿›åº¦</a></h2><h3 class=article-subtitle>åœ¨å¤šçº¿ç¨‹æƒ…å½¢ä¸‹ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¼šå¸Œæœ›æœ‰åŠæ³•æ±‡æŠ¥è¿›åº¦ï¼Œå´å¸¸å¸¸ä¼šé‡åˆ°çº¿ç¨‹ä¸å®‰å…¨ä¹‹ç±»çš„é—®é¢˜ã€‚é‚£ä¹ˆå®˜æ–¹ç»™å‡ºçš„å®è·µæ–¹å¼æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2024-05-09T00:00:00Z>May 09, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 4 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><blockquote><p>æœ¬æ–‡æœ‰å¯¹åº”çš„è§†é¢‘æ•™ç¨‹ï¼š<a class=link href=https://www.bilibili.com/video/BV1SD421P76s/ target=_blank rel=noopener>å“”å“©å“”å“©</a></p></blockquote><p>åœ¨æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡æ—¶ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¼šå¸Œæœ›æœ‰åŠæ³•æ±‡æŠ¥è¿›åº¦ã€‚æ¯”å¦‚åœ¨ä¸€ä¸ª WPF ç¨‹åºä¸­ï¼Œæˆ‘ä»¬åœ¨ç•Œé¢ä¸Šæ”¾äº†ä¸€ä¸ªè¿›åº¦æ¡ï¼Œä»è€Œå±•ç¤ºå½“å‰ä»»åŠ¡çš„è¿›åº¦ã€‚é‚£ä¹ˆè¯¥å¦‚ä½•æ±‡æŠ¥å¼‚æ­¥ä»»åŠ¡çš„è¿›åº¦å‘¢ï¼Ÿ</p><p>å…¶å® .NET æ ‡å‡†åº“å°±ä¸ºæˆ‘ä»¬æä¾›äº†å®ç°è¿™ä¸€åŠŸèƒ½çš„æ¥å£å’Œç±»ï¼š<code>IProgress&lt;T></code> ä¸ <code>Progress&lt;T></code>ï¼Œå…¶ä¸­ <code>T</code> æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ï¼Œè¡¨ç¤ºè¦æ±‡æŠ¥çš„å†…å®¹ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›æ±‡æŠ¥ä¸€ä¸ªç™¾åˆ†æ¯”è¿›åº¦ï¼Œé‚£ä¹ˆä½¿ç”¨ <code>double</code> ç±»å‹å³å¯ï¼›ç±»ä¼¼åœ°ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›æ±‡æŠ¥ä¸€äº›æ›´åŠ å¤æ‚çš„å†…å®¹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <code>string</code> ç”šè‡³ä¸€äº›è‡ªå®šä¹‰ç±»ä¸ç»“æ„ä½“ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹è¯¥å¦‚ä½•ä½¿ç”¨å§ã€‚</p><h2 id=æ­å»ºé¡¹ç›®>æ­å»ºé¡¹ç›®
<a href=#%e6%90%ad%e5%bb%ba%e9%a1%b9%e7%9b%ae class=anchor>&para;</a></h2><p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€æ˜“çš„ WPF é¡¹ç›®ã€‚å› ä¸ºè¿™æ¬¡çš„ä»»åŠ¡æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸éµå¾ª MVVM æ¨¡å¼äº†ï¼Œè€Œæ˜¯ä½¿ç”¨æœ€ä¼ ç»Ÿçš„ WPF äº‹ä»¶æ³¨å†Œçš„æ–¹å¼ã€‚</p><p>å®ƒçš„ <code>MainWindow</code> å½¢å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Window</span> <span class=err>...</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;StackPanel</span> <span class=na>VerticalAlignment=</span><span class=s>&#34;Center&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;Button</span> <span class=na>Width=</span><span class=s>&#34;100&#34;</span>
</span></span><span class=line><span class=cl>                <span class=na>Margin=</span><span class=s>&#34;0,0,0,10&#34;</span>
</span></span><span class=line><span class=cl>                <span class=na>Content=</span><span class=s>&#34;Run&#34;</span>
</span></span><span class=line><span class=cl>                <span class=na>Click=</span><span class=s>&#34;Button_Click&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;ProgressBar</span> <span class=na>Height=</span><span class=s>&#34;20&#34;</span>
</span></span><span class=line><span class=cl>                     <span class=na>d:Value=</span><span class=s>&#34;10&#34;</span>
</span></span><span class=line><span class=cl>                     <span class=na>Name=</span><span class=s>&#34;progressBar&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/StackPanel&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Window&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶ååœ¨ <code>MainWindow.xaml.cs</code> ä¸­å®ç°ä¸€äº›ç®€å•çš„é€»è¾‘ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=kd>public</span> <span class=kd>partial</span> <span class=k>class</span> <span class=nc>MainWindow</span> <span class=p>:</span> <span class=n>Window</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>MainWindow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>InitializeComponent</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>async</span> <span class=k>void</span> <span class=n>Button_Click</span><span class=p>(</span><span class=kt>object</span> <span class=n>sender</span><span class=p>,</span> <span class=n>RoutedEventArgs</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>DoJobAsync</span><span class=p>(</span><span class=n>CancellationToken</span><span class=p>.</span><span class=n>None</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>async</span> <span class=n>Task</span> <span class=n>DoJobAsync</span><span class=p>(</span><span class=n>CancellationToken</span> <span class=n>token</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>token</span><span class=p>.</span><span class=n>IsCancellationRequested</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;</span> <span class=m>100</span><span class=p>;</span> <span class=n>i</span><span class=p>++)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>Task</span><span class=p>.</span><span class=n>Delay</span><span class=p>(</span><span class=m>50</span><span class=p>,</span> <span class=n>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>progressBar</span><span class=p>.</span><span class=n>Value</span> <span class=p>=</span> <span class=n>i</span> <span class=p>+</span> <span class=m>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>token</span><span class=p>.</span><span class=n>IsCancellationRequested</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬å°†æŒ‰é’®æ³¨å†Œçš„ <code>Button_Click</code> æ–¹æ³•ä¿®æ”¹ä¸º <code>async void</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨é‡Œé¢ç­‰å¾…ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡äº†ã€‚</p><div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Info</div><div class=notice-content>è™½ç„¶ <code>async void</code> æ˜¯ä¸€ç§éå¸¸å±é™©çš„æ–¹å¼ï¼Œä½†å› ä¸º <code>Button</code> æ§ä»¶çš„ <code>Click</code> äº‹ä»¶å¯¹åº”å§”æ‰˜å¯¹äºå‡½æ•°ä¼ å‚åŠè¿”å›å€¼çš„é™åˆ¶ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸å¾—ä¸è¿™æ ·åšã€‚</div></div><p>ç„¶åï¼Œæˆ‘ä»¬åœ¨ <code>DoJobAsync</code> ä¸­å®ç°åå°çš„å¼‚æ­¥ä»»åŠ¡ã€‚è¿™é‡Œæˆ‘ä»¬ç®€å•åœ°ä½¿ç”¨ä¸€ä¸ª <code>for</code> å¾ªç¯ï¼Œå¹¶åœ¨å…¶ä¸­ä½¿ç”¨ <code>Task.Delay</code>ï¼Œä»è€Œå®ç°ä¸€ä¸ªæ‹¥æœ‰è¿›åº¦çš„å¼‚æ­¥ä»»åŠ¡ã€‚ç„¶åï¼Œæˆ‘ä»¬åœ¨æ¯æ¬¡å¾ªç¯ä¸­ç›´æ¥ä¿®æ”¹ <code>progressBar</code> æ§ä»¶çš„å€¼ã€‚è¿è¡Œç¨‹åºï¼Œå°±å¯ä»¥ç›´æ¥çœ‹åˆ°æ•ˆæœäº†ï¼š</p><p><img src=https://s2.loli.net/2024/05/09/F6o97PzSaO4kiDc.gif loading=lazy alt=åŠ¨ç”»></p><p>è¿™ä¸ªé—®é¢˜éš¾é“å°±è¿™ä¹ˆè½»æ¾åœ°å°±è§£å†³äº†å—ï¼Ÿå…¶å®ä¸æ˜¯çš„ï¼Œå› ä¸ºåœ¨å¼‚æ­¥ä»»åŠ¡ä¸­ï¼Œå¾ˆå¯èƒ½ä¼šå‡ºç°åœ¨åˆ«çš„çº¿ç¨‹ä¸­æ“ä½œ UI çº¿ç¨‹çš„èµ„æºï¼ˆä¹Ÿå°±æ˜¯æ§ä»¶åŠå…¶å±æ€§ï¼‰ï¼Œè¿™ç§æƒ…å†µä¸‹ç¨‹åºä¼šæŠ¥é”™ã€‚æ‰€ä»¥å¦‚æœä½¿ç”¨è¿™æ ·çš„æ–¹å¼ï¼Œé€šå¸¸æˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨è€å¥—çš„ <code>Dispatcher.Invoke</code> çš„æ–¹å¼æ¥è§„é¿è¿™ä¸ªé—®é¢˜ã€‚ä½†è¿™æ ·å°±æ˜¾å¾—ä¸å¤Ÿä¼˜é›…äº†ã€‚</p><p>é‚£ä¹ˆåŒæ ·çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ä½¿ç”¨ <code>Progress</code> ç±»æ¥å®ç°å‘¢ï¼Ÿ</p><h2 id=ä½¿ç”¨-progress-ç±»>ä½¿ç”¨ Progress ç±»
<a href=#%e4%bd%bf%e7%94%a8-progress-%e7%b1%bb class=anchor>&para;</a></h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ç¨ç¨ä¿®æ”¹ä¸€ä¸‹ <code>DoJobAsync</code> æ–¹æ³•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=kd>async</span> <span class=n>Task</span> <span class=n>DoJobAsync</span><span class=p>(</span><span class=n>IProgress</span><span class=p>&lt;</span><span class=kt>double</span><span class=p>&gt;</span> <span class=n>reporter</span><span class=p>,</span> <span class=n>CancellationToken</span> <span class=n>token</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;</span> <span class=m>100</span><span class=p>;</span> <span class=n>i</span><span class=p>++)</span>
</span></span><span class=line><span class=cl>   <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>token</span><span class=p>.</span><span class=n>IsCancellationRequested</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>       <span class=k>await</span> <span class=n>Task</span><span class=p>.</span><span class=n>Delay</span><span class=p>(</span><span class=m>50</span><span class=p>,</span> <span class=n>token</span><span class=p>).</span><span class=n>ConfigureAwait</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>       <span class=n>reporter</span><span class=p>.</span><span class=n>Report</span><span class=p>(</span><span class=n>i</span> <span class=p>+</span> <span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>       <span class=k>if</span> <span class=p>(</span><span class=n>token</span><span class=p>.</span><span class=n>IsCancellationRequested</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>{</span>
</span></span><span class=line><span class=cl>           <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>       <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åï¼Œè¿™ä¸ª <code>Progress</code> ç±»çš„å®ä¾‹æ¥è‡ªå“ªå„¿å‘¢ï¼Ÿæˆ‘ä»¬å†ä¿®æ”¹ä¸€ä¸‹ <code>Button_Click</code> æ–¹æ³•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=kd>private</span> <span class=kd>async</span> <span class=k>void</span> <span class=n>Button_Click</span><span class=p>(</span><span class=kt>object</span> <span class=n>sender</span><span class=p>,</span> <span class=n>RoutedEventArgs</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>reporter</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Progress</span><span class=p>&lt;</span><span class=kt>double</span><span class=p>&gt;(</span><span class=k>value</span> <span class=p>=&gt;</span> <span class=n>progressBar</span><span class=p>.</span><span class=n>Value</span> <span class=p>=</span> <span class=k>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>DoJobAsync</span><span class=p>(</span><span class=n>reporter</span><span class=p>,</span> <span class=n>CancellationToken</span><span class=p>.</span><span class=n>None</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å°±è¿™æ ·ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ä½¿ç”¨çš„æ—¶å€™å®ä¾‹åŒ–ä¸€ä¸ªæ–°çš„å³å¯ã€‚å®ƒé™¤äº†æˆ‘ä»¬å‰é¢æåˆ°çš„æ³›å‹ï¼Œè¿˜ä¼ å…¥äº†ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¡¨ç¤ºæ¯æ¬¡ <code>Report</code> æ—¶éœ€è¦æ‰§è¡Œçš„é€»è¾‘ã€‚è¿™é‡Œçš„é€»è¾‘éå¸¸ç®€å•ï¼Œåªéœ€è¦å°†ä¼ å…¥çš„ <code>double</code> ç±»å‹çš„æ•°å­—èµ‹å€¼ç»™è¿›åº¦æ¡çš„ <code>Value</code> å±æ€§å³å¯ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šå®ƒæ˜¯å¦‚ä½•è§„é¿äº†å‰é¢æåˆ°çš„çº¿ç¨‹é—®é¢˜çš„å‘¢ï¼Ÿæˆ‘ä»¬è§‚å¯Ÿ <code>Progress</code> ç±»çš„<a class=link href=https://source.dot.net/#System.Private.CoreLib/src/libraries/System.Private.CoreLib/src/System/Progress.cs,d23df0450d3fd0d6 target=_blank rel=noopener>æºä»£ç </a>ï¼Œå¯ä»¥å‘ç°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=kd>public</span> <span class=n>Progress</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Capture the current synchronization context.</span>
</span></span><span class=line><span class=cl>    <span class=c1>// If there is no current context, we use a default instance targeting the ThreadPool.</span>
</span></span><span class=line><span class=cl>    <span class=n>_synchronizationContext</span> <span class=p>=</span> <span class=n>SynchronizationContext</span><span class=p>.</span><span class=n>Current</span> <span class=p>??</span> <span class=n>ProgressStatics</span><span class=p>.</span><span class=n>DefaultContext</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Debug</span><span class=p>.</span><span class=n>Assert</span><span class=p>(</span><span class=n>_synchronizationContext</span> <span class=p>!=</span> <span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>_invokeHandlers</span> <span class=p>=</span> <span class=k>new</span> <span class=n>SendOrPostCallback</span><span class=p>(</span><span class=n>InvokeHandlers</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨å®ƒçš„æ„é€ å‡½æ•°ä¸­ï¼Œæ‹¥æœ‰ä¸€ä¸ª <code>SynchronizationContext</code> å¯¹è±¡ï¼Œå®ƒæŒæœ‰äº†å½“å‰çš„åŒæ­¥ä¸Šä¸‹æ–‡ã€‚å½“æˆ‘ä»¬åœ¨ <code>Button_Click</code> æ–¹æ³•ä¸­å£°æ˜å®ƒæ—¶ï¼Œå› ä¸ºè¿˜åœ¨ UI çº¿ç¨‹ï¼Œæ‰€ä»¥å®ƒå°±ä¿å­˜äº†è¿™ä¸ªä¸Šä¸‹æ–‡ã€‚ç„¶ååœ¨å®ƒçš„ <code>Report</code> æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå°±ä¼šåœ¨æ­£ç¡®çš„åŒæ­¥ä¸Šä¸‹æ–‡ï¼ˆä¹Ÿå°±æ˜¯ UI çº¿ç¨‹ï¼‰ä¸­æ‰§è¡Œç›¸å…³é€»è¾‘äº†ã€‚</p><div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Info</div><div class=notice-content>é™¤äº†ç»™æ„é€ å‡½æ•°ä¼ å›è°ƒï¼Œ<code>Progress</code> ç±»è¿˜ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª <code>ProgressChanged</code> äº‹ä»¶ã€‚æ³¨å†Œè¿™ä¸ªäº‹ä»¶å¯ä»¥å®ç°ç›¸åŒçš„æ•ˆæœï¼Œå¹¶ä¸”ä¹Ÿæ˜¯åœ¨ç›¸åŒçš„åŒæ­¥ä¸Šä¸‹æ–‡æ‰§è¡Œçš„ã€‚</div></div><h2 id=å®ç°è‡ªå®šä¹‰-progress-ç±»>å®ç°è‡ªå®šä¹‰ Progress ç±»
<a href=#%e5%ae%9e%e7%8e%b0%e8%87%aa%e5%ae%9a%e4%b9%89-progress-%e7%b1%bb class=anchor>&para;</a></h2><p>å¦‚æœæˆ‘ä»¬è¿˜æœ‰å…¶ä»–é¢å¤–çš„éœ€æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå·±å®ç°æ¥å£ï¼Œæˆ–è€…ç»§æ‰¿ <code>Progress</code> ç±»ã€‚å®˜æ–¹ç‰¹æ„æ²¡æœ‰å°†è¿™ä¸ªç±»è®¾ä¸º <code>sealed</code>ï¼Œå¹¶ä¸”å°† <code>OnReport</code> æ–¹æ³•è®¾ä¸º <code>virtual</code>ï¼Œå°±æ˜¯ä¸ºäº†æ»¡è¶³æˆ‘ä»¬çš„è¿™äº›éœ€æ±‚ã€‚</p><div class="notice note"><div class=notice-title><i class="fa-solid fa-sticky-note" aria-hidden=true></i>Note</div><div class=notice-content>ä½†æ˜¯å¦‚æœæˆ‘ä»¬å»ç»§æ‰¿è¿™ä¸ª <code>Progress</code> ç±»ï¼Œä¼šå‘ç°å…¶å®æˆ‘ä»¬èƒ½è‡ªç”±å‘æŒ¥çš„ç©ºé—´å¹¶ä¸å¤§ï¼Œå› ä¸ºå®ƒå…¶ä¸­çš„å¾ˆå¤šå­—æ®µï¼ˆå°¤å…¶æ˜¯åŒæ­¥ä¸Šä¸‹æ–‡ï¼‰éƒ½æ˜¯ <code>private</code> çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½åšçš„äº‹æƒ…åŸºæœ¬ä¸Šä¹Ÿåªæœ‰é‡å†™ <code>OnReport</code> æ–¹æ³•äº†ã€‚</div></div><p>æ¯”å¦‚è¿™é‡Œæˆ‘å†™äº†ä¸€ä¸ªå­ç±»ï¼Œä»è€Œå¯ä»¥åœ¨è¿›åº¦å®Œæˆåæ‰§è¡Œä¸€ä¸ªå›è°ƒæ–¹æ³•ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyProgress</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=p>:</span> <span class=n>Progress</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=k>where</span> <span class=n>T</span> <span class=p>:</span> <span class=n>notnull</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=n>Action</span><span class=p>?</span> <span class=n>_complete</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=n>T</span> <span class=n>_maximum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>bool</span> <span class=n>_isCompleted</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>MyProgress</span><span class=p>(</span><span class=n>Action</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;</span> <span class=n>handler</span><span class=p>,</span> <span class=n>Action</span><span class=p>?</span> <span class=n>complete</span><span class=p>,</span> <span class=n>T</span> <span class=n>maximum</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>:</span> <span class=k>base</span><span class=p>(</span><span class=n>handler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_complete</span> <span class=p>=</span> <span class=n>complete</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>_maximum</span> <span class=p>=</span> <span class=n>maximum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>ProgressChanged</span> <span class=p>+=</span> <span class=n>CheckCompletion</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kd>override</span> <span class=k>void</span> <span class=n>OnReport</span><span class=p>(</span><span class=n>T</span> <span class=k>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>_isCompleted</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>base</span><span class=p>.</span><span class=n>OnReport</span><span class=p>(</span><span class=k>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>void</span> <span class=n>CheckCompletion</span><span class=p>(</span><span class=kt>object?</span> <span class=n>sender</span><span class=p>,</span> <span class=n>T</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>Equals</span><span class=p>(</span><span class=n>_maximum</span><span class=p>)</span> <span class=p>&amp;&amp;</span> <span class=p>!</span><span class=n>_isCompleted</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_isCompleted</span> <span class=p>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>_complete</span><span class=p>?.</span><span class=n>Invoke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥è¿™æ ·ä½¿ç”¨äº†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=kd>private</span> <span class=kd>async</span> <span class=k>void</span> <span class=n>Button_Click</span><span class=p>(</span><span class=kt>object</span> <span class=n>sender</span><span class=p>,</span> <span class=n>RoutedEventArgs</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>reporter</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MyProgress</span><span class=p>&lt;</span><span class=kt>double</span><span class=p>&gt;(</span>
</span></span><span class=line><span class=cl>        <span class=k>value</span> <span class=p>=&gt;</span> <span class=n>progressBar</span><span class=p>.</span><span class=n>Value</span> <span class=p>=</span> <span class=k>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>()</span> <span class=p>=&gt;</span> <span class=n>progressBar</span><span class=p>.</span><span class=n>Visibility</span> <span class=p>=</span> <span class=n>Visibility</span><span class=p>.</span><span class=n>Hidden</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=m>100</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>DoJobAsync</span><span class=p>(</span><span class=n>reporter</span><span class=p>,</span> <span class=n>CancellationToken</span><span class=p>.</span><span class=n>None</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œå®ç°çš„æ•ˆæœæ˜¯ï¼Œå½“å¼‚æ­¥ä»»åŠ¡å®Œæˆåï¼Œå°†ä¼šéšè—è¿›åº¦æ¡ã€‚</p><h2 id=æ€»ç»“>æ€»ç»“
<a href=#%e6%80%bb%e7%bb%93 class=anchor>&para;</a></h2><p>ä¸çŸ¥é“å¤§å®¶çœ‹å®Œè¿™ç¯‡æ–‡ç« çš„æ„Ÿå—å¦‚ä½•ã€‚å…¶å®æˆ‘åœ¨æœ€å¼€å§‹äº†è§£æ–‡ä¸­æåˆ°çš„ <code>IProgress</code> æ¥å£ä»¥åŠ <code>Progress</code> ç±»æ—¶ï¼Œæœ€å¤§çš„æ„Ÿå—æ˜¯ï¼šå¾®è½¯ç©¶ç«Ÿä¸ºæˆ‘ä»¬æå‰å‡†å¤‡å¥½äº†å¤šå°‘æ¥å£å’Œç±»å•ŠğŸ¤£ï¼</p><p>.NET ç±»ä¸­æœ‰å¤ªå¤šè¿™æ ·çš„æ ‡å‡†åº“äº†ï¼Œä½†æˆ‘ä»¬ä¹Ÿæ²¡æœ‰ä»€ä¹ˆåŠæ³•å»ç³»ç»Ÿåœ°æŒ–æ˜ä¸æ€»ç»“ã€‚æ‰€ä»¥åªèƒ½ä»°ä»—å¤§å®¶ä»ŠåæŒç»­ä¸æ–­çš„äº¤æµä¸å­¦ä¹ äº†ã€‚</p><h2 id=å‚è€ƒ>å‚è€ƒ
<a href=#%e5%8f%82%e8%80%83 class=anchor>&para;</a></h2><p><a class=link href="https://www.youtube.com/watch?v=zQMNFEz5IVU" target=_blank rel=noopener>How to Report Progress with Async/Await in .NET Core 3 - YouTube</a></p><p><a class=link href="https://www.youtube.com/watch?v=ZTKGRJy5P2M" target=_blank rel=noopener>C# Advanced Async - Getting progress reports, cancelling tasks, and more - YouTube</a></p></section><footer class=article-footer><section class=article-tags><a href=/tags/csharp/>csharp</a>
<a href=/tags/dotnet/>dotnet</a>
<a href=/tags/async/>async</a>
<a href=/tags/wpf/>wpf</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>ä½¿ç”¨ CC BY-NC-SA 4.0 åè®®</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/posts/use-efcore-in-client-app/><div class=article-details><h2 class=article-title>å¦‚ä½•åœ¨æœ¬åœ°å®¢æˆ·ç«¯ä½¿ç”¨ EF Core</h2></div></a></article><article><a href=/posts/built-in-design-patterns-in-wpf/><div class=article-details><h2 class=article-title>åŸç”Ÿ WPF æ¡†æ¶ä¸­ä½“ç°å‡ºçš„è®¾è®¡æ¨¡å¼</h2></div></a></article><article><a href=/posts/more-observable-collections/><div class=article-details><h2 class=article-title>å€ŸåŠ© ObservableCollections è·å¾—æ›´å¤šå…·æœ‰é€šçŸ¥åŠŸèƒ½çš„é›†åˆç±»å‹</h2></div></a></article><article><a href=/posts/how-many-timers-are-there/><div class=article-details><h2 class=article-title>.NET åŸç”Ÿæœ‰å“ªäº› Timer ä»¥åŠå®ƒä»¬åˆ†åˆ«æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ</h2></div></a></article><article><a href=/posts/contentcontrol-vs-contentpresenter/><div class=article-details><h2 class=article-title>WPF ä¸­çš„ ContentControl åŠ ContentPresenter æœ‰ä½•å¼‚åŒï¼Ÿ</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=BYJRK/byjrk.github.io data-repo-id=R_kgDOLoIulQ data-category=Announcements data-category-id=DIC_kwDOLoIulc4CenQE data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2026 å¯’æµã®ç¼–ç¨‹ç¬”è®°</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>